{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#home","title":"Home","text":""},{"location":"#about","title":"About","text":"<p>Helm Charts and deployment documentation for the American Archive of Public Broadcasting (AAPB)</p>"},{"location":"#links","title":"Links","text":"<ul> <li>Production site: americanarchive.org</li> <li>Development site: aapb.dev.wgbh-mla.org</li> <li>User documentation: TODO</li> <li>Source code: github.com/WGBH-MLA/dream-aapb</li> <li>Helm chart: wgbh-mla.github.io/aapb-deploy</li> <li>Artifact Hub: artifacthub.io/packages/helm/aapb/aapb</li> </ul>"},{"location":"#documentation","title":"Documentation","text":"<ul> <li>Quickstart for installation instructions</li> <li>Tutorials for additional how-tos and setup instructions</li> <li>Guides for deployment and maintenance operations</li> <li>Reference for technical information</li> <li>About for project and organization information</li> <li>Architecture for an overview of the deployment infrastructure and GitOps flows</li> </ul>"},{"location":"#credits","title":"Credits","text":"<p>Developed by the GBH Archives at WGBH Boston</p>"},{"location":"about/","title":"About","text":""},{"location":"about/#about","title":"About","text":"<p>This section provides information about the AAPB deployment, and the organizations involved in its development and maintenance, as well as links to additional resources and documentation.</p>"},{"location":"about/#architecture","title":"Architecture","text":"<p>See the Architecture Overview for a high-level description of the AAPB system architecture.</p>"},{"location":"about/#organizations","title":"Organizations","text":""},{"location":"about/#aapb","title":"AAPB","text":"<p>The American Archive for Public Broadcasting (AAPB) is a collaboration between the Library of Congress and GBH to coordinate a national effort to preserve and make accessible significant public broadcasting programs.</p> <p>Visit americanarchive.org for more information</p>"},{"location":"about/#gbh","title":"GBH","text":"<p>See the GBH website for more information about GBH and its initiatives.</p>"},{"location":"about/#media-library-and-archives","title":"Media Library and Archives","text":"<p>The AAPB application is developed and maintained by the Media Library and Archives department (MLA) at GBH in Boston, MA.</p> <p>Visit the Archives website for more information about the Media Library and Archives department.</p>"},{"location":"architecture/","title":"Architecture","text":""},{"location":"architecture/#architecture","title":"Architecture","text":"<p>This section provides a high-level overview of the architecture of the AAPB application, including its components and how they interact with each other.</p> <p>For installation instructions, see the Quickstart Guide.</p>"},{"location":"architecture/#deployment","title":"Deployment","text":"<p>The AAPB application is deployed on a Kubernetes cluster using Helm charts for package management and Argo CD for continuous deployment.</p> <p>The following diagram illustrates the kubernetes architecture of a single AAPB instance:</p> <p></p>"},{"location":"architecture/#gitops","title":"GitOps","text":"<p>Deployments are managed using a GitOps strategy, with Argo CD Applications.</p> <p>The following diagram illustrates the GitOps architecture of the aapb-deploy repository:</p> <p></p>"},{"location":"guides/","title":"Guides","text":""},{"location":"guides/#guides","title":"Guides","text":"<p>Management, maintenance and deployment guides for AAPB</p> <ul> <li>ArgoCD deployment parameters</li> <li>Elasticsearch index management</li> <li>Helm chart updating and publishing</li> </ul>"},{"location":"guides/argo/","title":"Argo CD","text":""},{"location":"guides/argo/#argo-cd","title":"Argo CD","text":"<p>Deployments are managed via Argo CD, a declarative, GitOps continuous delivery tool for Kubernetes.</p>"},{"location":"guides/argo/#links","title":"Links","text":"<ul> <li>cd.dev.wgbh-mla.org/ - Dev cluster</li> <li>cd.wgbh-mla.org/ - Prod cluster (not yet set up)</li> </ul> Admin Access <p>Access to the Argo CD web interface is restricted. Contact the WGBH Archives team for access.</p> <pre><code># Get the initial admin password\nkubectl -n argo-cd get secret argocd-initial-admin-secret -o json | jq -r .data.password | base64 -d\n</code></pre>"},{"location":"guides/argo/#deploying-a-new-image","title":"Deploying a new image","text":""},{"location":"guides/argo/#case-1-restart-deployment","title":"Case 1: Restart deployment","text":"<p>If the new image has the same tag as the previous image (e.g. <code>latest</code>), restart the deployment to pull the new image.</p>"},{"location":"guides/argo/#case-2-update-image-tag","title":"Case 2: Update image tag","text":"<p>If the new image has a different tag, update the image tag value in the ArgoCD web interface.</p>"},{"location":"guides/argo/#case-3-update-image-repository","title":"Case 3: Update image repository","text":"<p>If the new image is in a different repository, update the image repository parameter in the ArgoCD web interface.</p>"},{"location":"guides/argo/#updating-parameters","title":"Updating Parameters","text":"<p>In addition to the image tag and repository, other parameters can be modified under the Parameters tab in the ArgoCD web interface. These parameters correspond to the values in the Helm chart's <code>values.yaml</code> file.</p> <p></p>"},{"location":"guides/docs/","title":"Documentation","text":""},{"location":"guides/docs/#documentation","title":"Documentation","text":"<p>The <code>docs/</code> directory contains all the files for the documentation website, built with mkdocs and hosted on GitHub Pages.</p>"},{"location":"guides/docs/#local-development","title":"Local Development","text":"<p>To build and serve the documentation locally, you need to have Python and <code>uv</code> installed. </p>"},{"location":"guides/docs/#1-install-uv","title":"1. Install <code>uv</code>","text":"<pre><code>pip install uv\n</code></pre>"},{"location":"guides/docs/#2-clone-the-repository-and-navigate-to-the-docs-directory","title":"2. Clone the repository and navigate to the <code>docs/</code> directory:","text":"<pre><code>git clone https://github.com/WGBH-MLA/aapb-deploy.git\ncd aapb-deploy/docs/\n</code></pre>"},{"location":"guides/docs/#3-sync-the-dependencies","title":"3. Sync the dependencies:","text":"<pre><code>uv sync\n</code></pre>"},{"location":"guides/docs/#4-run-the-mkdocs-server","title":"4. Run the mkdocs server:","text":"<pre><code>uv run mkdocs serve\n</code></pre> <p>The documentation can be accessed at localhost:8000</p> <p>Changes to the <code>docs/</code> files will be rebuilt automatically and reloaded in the browser.</p>"},{"location":"guides/docs/#pushing-changes","title":"Pushing changes","text":"<p>To update the published documentation, commit your changes to the <code>docs</code> branch and push them to the remote repository:</p> <p>This will trigger the <code>docs.yaml</code> GitHub Actions workflow to build and deploy the updated documentation to GitHub Pages.</p> <p>Merging the <code>docs</code> branch into the <code>main</code> branch will also trigger the workflow to re-deploy the latest version of the documentation.</p>"},{"location":"guides/docs/#version-numbers","title":"Version numbers","text":"<p>Version numbers in the documentation are managed using mike. This allows multiple versions of the documentation to be maintained and accessed independently, e.g. <code>v0.1</code>, <code>v0.2</code>, etc.</p>"},{"location":"guides/docs/#eg-adding-a-new-version","title":"e.g., Adding a new version","text":"<p>To add a new version (e.g. <code>v0.2</code>) and set it as the latest version, run:</p> <pre><code>mike deploy -u v0.2 latest\n</code></pre> <p>This will create a new version of the documentation and update the <code>latest</code> alias to point to this new version. These changes will be added to the local <code>gh-pages</code> branch of the repository.</p>"},{"location":"guides/docs/#test-new-version-locally","title":"Test new version locally","text":"<pre><code>mike serve\n</code></pre> Visit localhost:8000 and test the new version of the documentation."},{"location":"guides/docs/#publishing-the-new-version","title":"Publishing the new version","text":"<p>To publish the new version to GitHub Pages, push the <code>gh-pages</code> branch to the remote repository:</p> <pre><code>git push origin gh-pages\n</code></pre> <p>The <code>docs.yaml</code> GitHub Actions workflow will automatically deploy the updated documentation to GitHub Pages.</p>"},{"location":"guides/elastic/","title":"Elasticsearch","text":""},{"location":"guides/elastic/#elasticsearch","title":"Elasticsearch","text":""},{"location":"guides/elastic/#introduction","title":"Introduction","text":""},{"location":"guides/elastic/#indexes","title":"Indexes","text":""},{"location":"guides/elastic/#reindexing","title":"Reindexing","text":""},{"location":"guides/helm/","title":"Helm","text":""},{"location":"guides/helm/#helm","title":"Helm","text":""},{"location":"guides/helm/#update-helm-chart","title":"Update Helm Chart","text":""},{"location":"guides/helm/#publish-helm-chart","title":"Publish Helm Chart","text":""},{"location":"guides/helm/#update-deployment-version","title":"Update deployment version","text":""},{"location":"ref/","title":"Reference","text":""},{"location":"ref/#reference","title":"Reference","text":"<p>Reference documentation for AAPB Helm chart and related infrastructure.</p>"},{"location":"ref/#helm-chart","title":"Helm Chart","text":"<p>TODO</p>"},{"location":"tutorials/","title":"Tutorials","text":""},{"location":"tutorials/#tutorials","title":"Tutorials","text":"<p>This section contains tutorials for using and administering the AAPB application.</p>"},{"location":"tutorials/#quickstart","title":"Quickstart","text":"<p>See Quickstart tutorial for installation instructions</p>"},{"location":"tutorials/#upgrading","title":"Upgrading","text":"<p>See Upgrading tutorial for instructions on upgrading the AAPB application.</p>"},{"location":"tutorials/helm/","title":"Helm chart deployment","text":""},{"location":"tutorials/helm/#helm-chart-deployment","title":"Helm chart deployment","text":"<p>AAPB can be deployed as a simple Helm Chart to a Kubernetes cluster.</p> <p>Setup</p> <p>If you haven't set up a production environment, follow the steps in Quickstart first.</p>"},{"location":"tutorials/helm/#install","title":"Install","text":"<p>Add the Helm repository: </p><pre><code>helm repo add aapb https://wgbh-mla.github.io/aapb-deploy\n</code></pre><p></p> <p>Update the charts: </p><pre><code>helm repo update\n</code></pre><p></p> <p>Customize the values in <code>values.yaml</code> to your needs. You can also use <code>--set</code> to override values on the command line. </p><pre><code>global:\n  backend:\n    image:\n      tag: latest\n</code></pre><p></p> <p>Install the Helm chart: </p><pre><code>helm install my-aapb aapb/aapb\n</code></pre><p></p>"},{"location":"tutorials/helm/#upgrade","title":"Upgrade","text":"<pre><code>helm upgrade my-aapb aapb/aapb\n</code></pre>"},{"location":"tutorials/helm/#values","title":"Values","text":"<p>See the values.yaml file for the full list of configurable values and their defaults.</p>"},{"location":"tutorials/helm/#uninstall","title":"Uninstall","text":"<pre><code>helm uninstall [release-name]\n</code></pre> ... where <code>[release-name]</code> is the name you used when installing the chart (e.g. <code>my-aapb</code>)."},{"location":"tutorials/quickstart/","title":"Quickstart","text":""},{"location":"tutorials/quickstart/#quickstart","title":"Quickstart","text":"<p>This guide provides a quick overview of how to deploy the AAPB application.</p> <p>For an overview of the application architecture and GitOps structure, see the Architecture Overview.</p> <p>There are two main ways to deploy the AAPB application: 1. Using Argo CD (recommended) 2. Using Helm</p> Prerequisites <p>These instructions assume you have a working Kubernetes cluster and admin access to it.</p> <p>The <code>kubectl</code> commands can be adapted for use with <code>k9s</code> or any other Kubernetes management tool.</p> Namespaces <p>Creating a namespace is optional but recommended to keep resources organized and separated from other applications.</p> <p>This also allows you to easily uninstall the application and all its resources by simply deleting the namespace.</p>"},{"location":"tutorials/quickstart/#create-a-namespace","title":"Create a namespace","text":"<p>Create a new namespace, in this case: <code>aapb</code>:</p> <pre><code>kubectl create namespace aapb\n</code></pre> <p>Set the current context to the new namespace: </p><pre><code>kubectl config set-context --current --namespace=aapb\n</code></pre><p></p> <p>Verify the current context </p><pre><code>kubectl config view --minify | grep namespace:\n</code></pre><p></p>"},{"location":"tutorials/quickstart/#install-with-argo-cd-recommended","title":"Install with Argo CD (Recommended)","text":"<ol> <li>Login to the Argo CD web interface: cd.dev.wgbh-mla.org</li> <li>Create a new application in Argo CD with the following settings:<ul> <li>Application Name: <code>aapb</code></li> <li>Project: <code>aapb</code></li> <li>Sync Policy: Automatic</li> <li>Repo URL: <code>https://wgbh-mla.github.io/aapb-deploy/</code></li> <li>Make sure to select <code>Helm</code> as the type, not <code>Git</code></li> <li>Target Revision: Use the latest helm chart version</li> <li>Chart: <code>aapb</code></li> </ul> </li> <li>Set other options for your deployment like Cluster and Namespace</li> <li>Click Create to deploy the application</li> </ol> <p>The application will be deployed automatically. You can monitor the progress in the Argo CD web interface.</p>"},{"location":"tutorials/quickstart/#install-with-helm","title":"Install with  Helm","text":"<p>Installing the AAPB application using Helm is straightforward. Follow the steps below:</p>"},{"location":"tutorials/quickstart/#add-helm-repository","title":"Add Helm Repository","text":"<p>Add the Helm repository for the AAPB application: </p><pre><code>helm repo add aapb https://wgbh-mla.github.io/aapb-deploy/\nhelm repo update\n</code></pre><p></p>"},{"location":"tutorials/quickstart/#install-the-application","title":"Install the Application","text":"<p>Install the AAPB application using Helm: </p><pre><code>helm install aapb aapb/aapb -n aapb\n</code></pre><p></p>"},{"location":"tutorials/upgrade/","title":"Upgrading AAPB","text":""},{"location":"tutorials/upgrade/#upgrading-aapb","title":"Upgrading AAPB","text":"<p>This guide provides instructions for upgrading the AAPB application deployed via Helm.</p>"},{"location":"tutorials/upgrade/#tldr","title":"TLDR","text":"<p>After the automated build process is complete, update the image in the kubernetes deployment.</p>"},{"location":"tutorials/upgrade/#case-1-using-argocd","title":"Case 1: Using ArgoCD","text":"<ol> <li>Log in to the ArgoCD web interface</li> <li>Navigate to the AAPB application</li> <li>In the <code>aapb</code> deployment resource sub-menu, click the \"Refresh\" option</li> </ol> <p>The deployment will pull the updated image and restart the pods automatically.</p>"}]}